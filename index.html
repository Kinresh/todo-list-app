<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Todo List App</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.4/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.1/umd/lucide.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
                'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
                sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;
        const { Plus, Trash2, CheckSquare, Square, ListTodo } = lucide;

        const TodoApp = () => {
            const [ideas, setIdeas] = useState([]);
            const [newIdea, setNewIdea] = useState('');
            const [isLoading, setIsLoading] = useState(false);

            // Load tasks from localStorage on component mount
            useEffect(() => {
                try {
                    const savedIdeas = localStorage.getItem('todoIdeas');
                    if (savedIdeas) {
                        setIdeas(JSON.parse(savedIdeas));
                    }
                } catch (error) {
                    console.error('Error loading saved tasks:', error);
                }
            }, []);

            // Save tasks to localStorage whenever ideas change
            useEffect(() => {
                try {
                    localStorage.setItem('todoIdeas', JSON.stringify(ideas));
                } catch (error) {
                    console.error('Error saving tasks:', error);
                }
            }, [ideas]);

            // Convert to Pascal Case
            const toPascalCase = (str) => {
                return str.replace(/\w+/g, (word) => 
                    word.charAt(0).toUpperCase() + word.slice(1).toLowerCase()
                );
            };

            // Add new idea
            const addIdea = async () => {
                if (!newIdea.trim()) return;
                
                setIsLoading(true);
                
                try {
                    const idea = {
                        id: Date.now(),
                        title: toPascalCase(newIdea),
                        description: '',
                        completed: false,
                        createdAt: new Date().toISOString(),
                        isEditing: false
                    };
                    
                    setIdeas(prev => [...prev, idea]);
                    setNewIdea('');
                } catch (error) {
                    console.error('Error adding idea:', error);
                } finally {
                    setIsLoading(false);
                }
            };

            // Toggle idea completion
            const toggleIdea = (id) => {
                setIdeas(prev => prev.map(idea => 
                    idea.id === id ? { ...idea, completed: !idea.completed } : idea
                ));
            };

            // Delete idea
            const deleteIdea = (id) => {
                setIdeas(prev => prev.filter(idea => idea.id !== id));
            };

            // Edit description
            const editDescription = (id, newDescription) => {
                setIdeas(prev => prev.map(idea => 
                    idea.id === id ? { ...idea, description: newDescription, isEditing: false } : idea
                ));
            };

            // Toggle editing mode
            const toggleEdit = (id) => {
                setIdeas(prev => prev.map(idea => 
                    idea.id === id ? { ...idea, isEditing: !idea.isEditing } : idea
                ));
            };

            // Format date and time
            const formatDateTime = (dateString) => {
                const date = new Date(dateString);
                const day = date.getDate();
                const month = date.toLocaleString('default', { month: 'short' });
                const year = date.getFullYear();
                const time = date.toLocaleTimeString('en-US', { 
                    hour: '2-digit', 
                    minute: '2-digit',
                    hour12: true 
                });
                
                const daySuffix = (day) => {
                    if (day > 3 && day < 21) return 'th';
                    switch (day % 10) {
                        case 1: return 'st';
                        case 2: return 'nd';
                        case 3: return 'rd';
                        default: return 'th';
                    }
                };
                
                return `${day}${daySuffix(day)} ${month} ${year} at ${time}`;
            };

            const handleKeyPress = (e) => {
                if (e.key === 'Enter') {
                    addIdea();
                }
            };

            return (
                <div className="max-w-4xl mx-auto p-2 sm:p-4 bg-gradient-to-br from-slate-50 to-gray-100 min-h-screen">
                    <div className="bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-white/20 p-4 sm:p-6 mb-4 sm:mb-6">
                        <div className="flex items-center gap-3 mb-4 sm:mb-6">
                            <div className="p-2 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl">
                                <ListTodo className="w-5 h-5 sm:w-6 sm:h-6 text-white" />
                            </div>
                            <h1 className="text-xl sm:text-2xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent">
                                Todo List
                            </h1>
                        </div>
                        
                        {/* Add new idea */}
                        <div className="flex gap-2 sm:gap-3">
                            <input
                                type="text"
                                value={newIdea}
                                onChange={(e) => setNewIdea(e.target.value)}
                                onKeyPress={handleKeyPress}
                                placeholder="Add your tasks here"
                                className="flex-1 px-3 sm:px-4 py-2 sm:py-3 border border-gray-200/50 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500/50 bg-white/50 backdrop-blur-sm transition-all text-sm sm:text-base"
                                disabled={isLoading}
                            />
                            <button
                                onClick={addIdea}
                                disabled={isLoading || !newIdea.trim()}
                                className="px-4 sm:px-6 py-2 sm:py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-xl hover:from-blue-600 hover:to-purple-700 disabled:from-gray-300 disabled:to-gray-400 disabled:cursor-not-allowed flex items-center gap-2 transition-all transform hover:scale-105 active:scale-95 text-sm sm:text-base"
                            >
                                <Plus className="w-4 h-4" />
                                <span className="hidden sm:inline">{isLoading ? 'Adding...' : 'Add'}</span>
                            </button>
                        </div>
                    </div>

                    {/* Ideas list */}
                    <div className="space-y-2">
                        {ideas.map((idea) => (
                            <div key={idea.id} className={`bg-white/80 backdrop-blur-sm rounded-xl shadow-sm border border-white/20 p-3 transition-all hover:shadow-md ${idea.completed ? 'opacity-60' : ''}`}>
                                <div className="flex items-center gap-3">
                                    <button
                                        onClick={() => toggleIdea(idea.id)}
                                        className="text-gray-400 hover:text-blue-500 transition-colors flex-shrink-0"
                                    >
                                        {idea.completed ? 
                                            <CheckSquare className="w-4 h-4 text-blue-500" /> : 
                                            <Square className="w-4 h-4" />
                                        }
                                    </button>
                                    
                                    <div className="flex-1 min-w-0">
                                        <div className="flex items-center justify-between gap-2">
                                            <div className="flex items-center gap-2 flex-1 min-w-0">
                                                <h3 className={`text-sm font-medium truncate ${idea.completed ? 'line-through text-gray-500' : 'text-gray-800'}`}>
                                                    {idea.title}
                                                </h3>
                                                <span className="text-xs text-gray-400 whitespace-nowrap hidden sm:inline">
                                                    {formatDateTime(idea.createdAt)}
                                                </span>
                                            </div>
                                            <div className="flex items-center gap-1 sm:gap-2 flex-shrink-0">
                                                <button
                                                    onClick={() => deleteIdea(idea.id)}
                                                    className="text-gray-400 hover:text-red-500 transition-colors"
                                                    title="Delete task"
                                                >
                                                    <Trash2 className="w-4 h-4" />
                                                </button>
                                            </div>
                                        </div>
                                        
                                        {/* Show date on mobile below title */}
                                        <span className="text-xs text-gray-400 block sm:hidden mt-1">
                                            {formatDateTime(idea.createdAt)}
                                        </span>
                                        
                                        {idea.isEditing ? (
                                            <div className="mt-1">
                                                <input
                                                    type="text"
                                                    defaultValue={idea.description}
                                                    className="w-full px-2 py-1 border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent text-xs"
                                                    onBlur={(e) => editDescription(idea.id, e.target.value)}
                                                    onKeyPress={(e) => {
                                                        if (e.key === 'Enter') {
                                                            e.preventDefault();
                                                            editDescription(idea.id, e.target.value);
                                                        }
                                                    }}
                                                    autoFocus
                                                />
                                            </div>
                                        ) : (
                                            idea.description && (
                                                <p 
                                                    className={`mt-1 cursor-pointer hover:bg-gray-50/50 px-2 py-1 rounded-lg transition-colors text-xs ${idea.completed ? 'line-through text-gray-500' : 'text-gray-600'}`}
                                                    onClick={() => toggleEdit(idea.id)}
                                                    title="Click to edit description"
                                                >
                                                    {idea.description}
                                                </p>
                                            )
                                        )}
                                    </div>
                                </div>
                            </div>
                        ))}
                    </div>

                    {ideas.length === 0 && (
                        <div className="text-center py-12">
                            <div className="p-4 bg-gradient-to-br from-blue-500 to-purple-600 rounded-2xl w-16 h-16 mx-auto mb-4 flex items-center justify-center">
                                <ListTodo className="w-8 h-8 text-white" />
                            </div>
                            <p className="text-gray-500 text-base sm:text-lg">
                                No tasks yet. Add your first task above!
                            </p>
                        </div>
                    )}
                </div>
            );
        };

        ReactDOM.render(<TodoApp />, document.getElementById('root'));
    </script>
</body>
</html>
